<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tanzimat Reforms: The Reform Ladder</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0d47a1 0%, #1a237e 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3949ab;
            padding-bottom: 20px;
        }

        h1 {
            color: #1a237e;
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            color: #5c6bc0;
            font-size: 1.2rem;
            font-style: italic;
        }

        /* Player Setup Modal */
        .player-setup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .setup-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .setup-content h2 {
            color: #1a237e;
            margin-bottom: 20px;
            text-align: center;
        }

        .player-input-group {
            margin-bottom: 20px;
        }

        .player-input-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .player-input-group input,
        .player-input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #c5cae9;
            border-radius: 8px;
            font-size: 1rem;
        }

        .player-input-group input:focus,
        .player-input-group select:focus {
            outline: none;
            border-color: #3949ab;
        }

        .player-color-preview {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-block;
            margin-left: 10px;
            border: 2px solid #333;
        }

        /* Game Layout */
        .game-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1100px) {
            .game-layout {
                grid-template-columns: 1fr;
            }
        }

        /* Chutes and Ladders Board */
        .board-container {
            position: relative;
            background: #f5f5f5;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            min-height: 600px;
        }

        .chutes-ladders-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(10, 1fr);
            gap: 5px;
            width: 600px;
            height: 600px;
            margin: 0 auto;
            background: #e3f2fd;
            padding: 10px;
            border-radius: 10px;
            border: 3px solid #1a237e;
            position: relative;
        }

        .board-cell {
            background: white;
            border: 2px solid #bbdefb;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 5px;
            text-align: center;
            position: relative;
            border-radius: 5px;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .board-cell:hover {
            transform: scale(1.05);
            z-index: 1;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            background: #e8eaf6;
        }

        .board-cell.active {
            border-color: #ff9800;
            background: #fff3e0;
        }

        .cell-number {
            position: absolute;
            top: 2px;
            left: 2px;
            font-size: 0.7rem;
            color: #666;
            font-weight: bold;
        }

        .cell-title {
            font-size: 0.7rem;
            font-weight: bold;
            margin-bottom: 2px;
            color: #1a237e;
        }

        .cell-description {
            font-size: 0.6rem;
            opacity: 0.8;
        }

        .player-token {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
            bottom: 3px;
            right: 3px;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            z-index: 2;
        }

        /* Ladders */
        .ladder {
            position: absolute;
            background: #4caf50;
            border-radius: 3px;
            z-index: 1;
        }

        .ladder-horizontal {
            height: 6px;
        }

        .ladder-vertical {
            width: 6px;
        }

        /* Chutes */
        .chute {
            position: absolute;
            background: #f44336;
            border-radius: 3px;
            z-index: 1;
        }

        .chute-horizontal {
            height: 6px;
        }

        .chute-vertical {
            width: 6px;
        }

        /* Dice Area */
        .dice-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
            padding: 20px;
            background: #e8eaf6;
            border-radius: 15px;
        }

        .dice-container {
            display: flex;
            gap: 20px;
        }

        .dice {
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: #1a237e;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.5s ease;
            cursor: pointer;
        }

        .dice.rolling {
            animation: rollDice 0.5s ease-in-out infinite;
        }

        @keyframes rollDice {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .dice:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Players Panel */
        .players-panel {
            background: #e8eaf6;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .player-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3949ab;
            transition: all 0.3s ease;
        }

        .player-card.active {
            border-left: 4px solid #4caf50;
            background: #f1f8e9;
            transform: translateX(5px);
        }

        .player-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .player-color-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #333;
        }

        .player-name {
            font-weight: bold;
            color: #1a237e;
            font-size: 1.1rem;
        }

        .player-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 0.9rem;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px solid #eee;
        }

        .stat-value {
            font-weight: bold;
            color: #3949ab;
        }

        /* Card Display */
        .card-display {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }

        .card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px 0;
        }

        .card-title {
            font-size: 1.5rem;
            color: #1a237e;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e8eaf6;
            width: 100%;
        }

        .card-text {
            font-size: 1.2rem;
            line-height: 1.6;
            color: #333;
            margin-bottom: 30px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
        }

        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            margin-top: 20px;
        }

        .answer-btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            background: #e8eaf6;
            color: #3949ab;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .answer-btn:hover:not(:disabled) {
            background: #3949ab;
            color: white;
            transform: translateY(-2px);
        }

        .answer-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 180px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3949ab 0%, #283593 100%);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(57, 73, 171, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: #e8eaf6;
            color: #3949ab;
        }

        .btn-secondary:hover:not(:disabled) {
            background: #c5cae9;
            transform: translateY(-3px);
        }

        .btn-secondary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .fact-result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-weight: bold;
            text-align: center;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .correct {
            background: #e8f5e9;
            color: #2e7d32;
            border: 2px solid #4caf50;
        }

        .incorrect {
            background: #ffebee;
            color: #c62828;
            border: 2px solid #f44336;
        }

        .game-log {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .log-title {
            font-weight: bold;
            color: #1a237e;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .log-entry {
            padding: 8px;
            border-bottom: 1px solid #ddd;
            font-size: 0.9rem;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .category-key {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .key-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .key-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .question-locked {
            pointer-events: none;
            opacity: 0.7;
        }

        .winner-banner {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #4caf50, #2e7d32);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            z-index: 1001;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            animation: popIn 0.5s ease;
        }

        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .winner-banner h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .winner-banner p {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }

        .space-answered {
            background: #e0e0e0 !important;
            border-color: #9e9e9e !important;
        }
    </style>
</head>
<body>
    <!-- Player Setup Modal -->
    <div class="player-setup" id="playerSetup">
        <div class="setup-content">
            <h2>üé≠ Setup Your Tanzimat Reform Ladder</h2>
            <div class="player-input-group">
                <label for="playerCount">Number of Reformers (2-4)</label>
                <select id="playerCount">
                    <option value="2">2 Reformers</option>
                    <option value="3" selected>3 Reformers</option>
                    <option value="4">4 Reformers</option>
                </select>
            </div>
            <div id="playerForms">
                <!-- Player forms will be generated here -->
            </div>
            <button class="btn btn-primary" id="startGameBtn" style="width: 100%; margin-top: 20px;">Start Reform Journey</button>
        </div>
    </div>

    <!-- Winner Banner -->
    <div class="winner-banner" id="winnerBanner">
        <h2>üéâ Reform Success! üéâ</h2>
        <p id="winnerMessage"></p>
        <button class="btn btn-primary" onclick="resetGame()">Play Again</button>
    </div>

    <div class="container" id="gameContainer" style="display: none;">
        <header>
            <h1>ü™ú Tanzimat Reform Ladder</h1>
            <p class="subtitle">Climb the ladder of Ottoman modernization! Beware of setbacks!</p>
        </header>

        <div class="game-layout">
            <div class="board-container">
                <div class="chutes-ladders-board" id="gameBoard">
                    <!-- Board cells will be generated by JavaScript -->
                </div>
                
                <div class="dice-area">
                    <h3>Current Reformer: <span id="currentPlayerName">-</span></h3>
                    <div class="dice-container">
                        <div class="dice" id="dice">‚öÄ</div>
                    </div>
                    <div class="controls">
                        <button class="btn btn-primary" id="rollDiceBtn" disabled>üé≤ Roll Dice</button>
                        <button class="btn btn-secondary" id="nextTurnBtn" style="display: none;" disabled>Continue Reform</button>
                    </div>
                    <div id="diceResult" style="font-size: 1.2rem; font-weight: bold; color: #1a237e;"></div>
                </div>
            </div>

            <div class="right-panel">
                <div class="players-panel" id="playersPanel">
                    <!-- Player cards will be generated here -->
                </div>

                <div class="card-display">
                    <div class="card-title" id="currentCategory">Welcome to Tanzimat Reforms!</div>
                    <div class="card-content">
                        <div class="card-text" id="cardText">
                            Click "Roll Dice" to begin your climb up the Reform Ladder. 
                            Answer questions correctly to advance, but beware of setbacks!
                        </div>
                        
                        <div class="answer-options" id="answerOptions" style="display: none;">
                            <!-- Answer buttons will be generated here -->
                        </div>
                        
                        <div class="fact-result" id="factResult">
                            <!-- Result message appears here -->
                        </div>
                    </div>
                </div>

                <div class="game-log">
                    <div class="log-title">Reform Chronicle:</div>
                    <div id="logEntries">
                        <div class="log-entry">Welcome to the Tanzimat Reform Ladder game!</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="category-key">
            <div class="key-item">
                <div class="key-color" style="background: #4caf50;"></div>
                <span>ü™ú Ladder - Progress Forward</span>
            </div>
            <div class="key-item">
                <div class="key-color" style="background: #f44336;"></div>
                <span>üõù Chute - Setback</span>
            </div>
            <div class="key-item">
                <div class="key-color" style="background: #2196f3;"></div>
                <span>‚ùì Question Space</span>
            </div>
            <div class="key-item">
                <div class="key-color" style="background: #ff9800;"></div>
                <span>‚ö° Event Space</span>
            </div>
        </div>
    </div>

    <script>
        // Game Configuration
        const PLAYER_COLORS = ['#FF5252', '#4CAF50', '#2196F3', '#FF9800'];
        const PLAYER_NAMES = ['Mustafa Re≈üid Pasha', 'Sultan Abd√ºlmecid I', 'Sultan Mahmud II', 'Young Ottoman'];
        const STARTING_KNOWLEDGE = 100; // Fixed starting knowledge
        
        // Chutes and Ladders Board Configuration (100 spaces)
        const BOARD_SPACES = Array.from({length: 100}, (_, i) => {
            const spaceNum = i + 1;
            let type = 'normal';
            let category = null;
            let title = '';
            let description = '';
            
            // Define ladders (progress)
            const ladders = {
                4: 25,   // Early Military Reform ‚Üí New Army
                13: 46,  // First Schools ‚Üí University
                22: 63,  // Legal Code ‚Üí Court System
                33: 49,  // Tax Reform ‚Üí Treasury
                41: 79,  // Postal Service ‚Üí Telegraph
                50: 69,  // Railway Start ‚Üí Network
                62: 81,  // Constitution Draft ‚Üí Promulgation
                74: 92,  // Industrial School ‚Üí Factory
                88: 94   // Press Law ‚Üí Newspapers
            };
            
            // Define chutes (setbacks)
            const chutes = {
                16: 6,   // Janissary Revolt ‚Üí Start over
                28: 10,  // Traditionalist Opposition ‚Üí Lost progress
                47: 26,  // Economic Crisis ‚Üí Austerity
                56: 37,  // Foreign Pressure ‚Üí Concessions
                64: 40,  // Bureaucratic Resistance ‚Üí Delays
                75: 52,  // Religious Opposition ‚Üí Compromise
                87: 66,  // Debt Crisis ‚Üí Foreign Control
                95: 70,  // Nationalist Uprising ‚Üí Repression
                99: 78   // Final Setback ‚Üí Major Delay
            };
            
            // Define special spaces
            if (ladders[spaceNum]) {
                type = 'ladder';
                title = 'Reform Success!';
                description = 'Climb to space ' + ladders[spaceNum];
            } else if (chutes[spaceNum]) {
                type = 'chute';
                title = 'Setback!';
                description = 'Slide to space ' + chutes[spaceNum];
            } else if ([3, 8, 15, 20, 30, 35, 42, 55, 60, 68, 72, 80, 85, 90, 98].includes(spaceNum)) {
                type = 'question';
                category = getCategoryForSpace(spaceNum);
                title = getTitleForSpace(spaceNum);
                description = 'Answer to proceed';
            } else if ([5, 12, 21, 32, 44, 51, 61, 73, 82, 96].includes(spaceNum)) {
                type = 'event';
                title = getEventTitle(spaceNum);
                description = 'Historical Event';
            }
            
            return {
                number: spaceNum,
                type: type,
                category: category,
                title: title || `Space ${spaceNum}`,
                description: description,
                ladderTo: ladders[spaceNum],
                chuteTo: chutes[spaceNum],
                answered: false // Track if question has been answered
            };
        });

        function getCategoryForSpace(spaceNum) {
            const categories = ['did-you-know', 'true-false', 'what-next', 'two-truths'];
            return categories[spaceNum % 4];
        }

        function getTitleForSpace(spaceNum) {
            const titles = [
                "Military Reform", "Tax Equalization", "Legal Code", "Education System",
                "Bureaucracy", "Infrastructure", "Foreign Policy", "Economy",
                "Conscription", "Land Reform", "Judicial System", "Banking",
                "Secularization", "Industrialization", "Constitution", "Modernization"
            ];
            return titles[spaceNum % 16];
        }

        function getEventTitle(spaceNum) {
            const events = [
                "Rose Garden Edict 1839", "Janissary Destruction 1826", "London Straits 1841",
                "Crimean War 1853", "Islahat Fermani 1856", "Debt Crisis 1875",
                "First Parliament 1877", "D√ºyun-u Umumiye 1881", "Young Turk Revolution 1908"
            ];
            return events[spaceNum % 9];
        }

        // Expanded facts database with more questions
        const facts = {
            'did-you-know': [
                {
                    text: "The G√ºlhane Hatt-ƒ± ≈ûerif (Rose Garden Edict) of 1839 was read in an open park to symbolize its public nature, promising equal treatment regardless of religion.",
                    points: 25
                },
                {
                    text: "Mustafa Re≈üid Pasha, architect of early Tanzimat, served as ambassador to Paris and London, directly importing European legal concepts.",
                    points: 30
                },
                {
                    text: "The first modern postal service in the Ottoman Empire was established in 1840, revolutionizing communication between provinces and Istanbul.",
                    points: 20
                },
                {
                    text: "New secular schools called 'r√º≈üdiye' were opened alongside traditional madrasas, creating a dual education system.",
                    points: 25
                },
                {
                    text: "The Land Code of 1858 aimed to create private property rights but often strengthened large landowners instead of peasants.",
                    points: 30
                },
                {
                    text: "Ottoman students sent to Europe for education returned as the 'Young Ottomans,' demanding constitutional government.",
                    points: 35
                },
                {
                    text: "The first Ottoman railway connected ƒ∞zmit to Istanbul in 1873, built with British investment and technology.",
                    points: 20
                },
                {
                    text: "New law codes mixed French commercial law with traditional Islamic law, creating legal confusion but also innovation.",
                    points: 25
                }
            ],
            'true-false': [
                {
                    text: "The Tanzimat reforms successfully eliminated all religious discrimination in the Ottoman Empire.",
                    answer: false,
                    explanation: "FALSE. While laws proclaimed equality, social practice and tradition maintained significant Muslim privilege.",
                    points: 40
                },
                {
                    text: "Sultan Mahmud II destroyed the Janissary corps in 1826 to clear the way for a modern European-style army.",
                    answer: true,
                    explanation: "TRUE. The 'Auspicious Incident' eliminated conservative military opposition to reform.",
                    points: 35
                },
                {
                    text: "All Ottoman subjects became eligible for military conscription regardless of religion after 1856.",
                    answer: false,
                    explanation: "FALSE. Non-Muslims could pay a military exemption tax instead, maintaining religious distinctions.",
                    points: 45
                },
                {
                    text: "The reforms were entirely initiated by Ottoman elites without European pressure.",
                    answer: false,
                    explanation: "FALSE. European powers, especially Britain and France, pressured for reforms to protect Christian minorities.",
                    points: 40
                },
                {
                    text: "Tanzimat created the first Ottoman central bank in 1856.",
                    answer: true,
                    explanation: "TRUE. The Ottoman Bank was established with British and French capital to stabilize finances.",
                    points: 50
                },
                {
                    text: "The reforms abolished the millet system completely.",
                    answer: false,
                    explanation: "FALSE. The millet system was reformed but not abolished; religious communities kept some autonomy.",
                    points: 45
                },
                {
                    text: "New secular courts (Nizamiye) operated alongside traditional Islamic courts.",
                    answer: true,
                    explanation: "TRUE. This created a complex dual legal system that sometimes conflicted.",
                    points: 40
                },
                {
                    text: "All Tanzimat reforms were completed by 1876 when the first constitution was proclaimed.",
                    answer: false,
                    explanation: "FALSE. Reform efforts continued into the 20th century, facing resistance and setbacks.",
                    points: 55
                }
            ],
            'what-next': [
                {
                    setup: "After the 1839 Rose Garden Edict promised equality and modern administration...",
                    options: [
                        "European powers immediately recognized Ottoman sovereignty over all territories.",
                        "New secular courts and modern schools were established despite resistance.",
                        "The Empire collapsed within five years due to traditionalist revolt."
                    ],
                    correct: 1,
                    explanation: "New institutions were created, but implementation faced constant resistance from conservatives and traditional elites.",
                    points: 50
                },
                {
                    setup: "When the Ottoman state sent students to study engineering and medicine in France...",
                    options: [
                        "They all returned to become loyal bureaucrats in the Sultan's government.",
                        "Many returned as critics demanding constitutional limits on the Sultan's power.",
                        "Most stayed in Europe and never returned to the Ottoman Empire."
                    ],
                    correct: 1,
                    explanation: "Western-educated intellectuals formed the 'Young Ottomans' movement pushing for parliamentary government.",
                    points: 55
                },
                {
                    setup: "Following the Crimean War (1853-1856), which exposed Ottoman military weakness...",
                    options: [
                        "The Empire abandoned all modernization efforts as too expensive.",
                        "Reforms accelerated with European support, leading to the 1856 Islahat Fermani.",
                        "Russia took direct control of Ottoman reform implementation."
                    ],
                    correct: 1,
                    explanation: "The 1856 Reform Edict expanded promises of equality under pressure from Britain and France.",
                    points: 60
                },
                {
                    setup: "After establishing the first Ottoman parliament in 1877...",
                    options: [
                        "It functioned smoothly for decades as a democratic institution.",
                        "Sultan Abd√ºlhamid II suspended it within a year and restored autocracy.",
                        "It immediately declared independence from the Ottoman Empire."
                    ],
                    correct: 1,
                    explanation: "The parliament was short-lived; Abd√ºlhamid II suspended it and ruled autocratically for 30 years.",
                    points: 65
                },
                {
                    setup: "When the Ottoman Empire declared bankruptcy in 1875...",
                    options: [
                        "All foreign debt was forgiven by European creditors.",
                        "The D√ºyun-u Umumiye (Public Debt Administration) was established under European control.",
                        "The Empire stopped all infrastructure projects indefinitely."
                    ],
                    correct: 1,
                    explanation: "European creditors took control of major revenue sources, limiting Ottoman financial independence.",
                    points: 70
                }
            ],
            'two-truths': [
                {
                    statements: [
                        "Sultan Mahmud II centralized power by crushing the Janissaries and regional governors.",
                        "Reformers planned gradual change over a century to avoid social disruption.",
                        "European-style uniforms and titles were adopted to project modern authority."
                    ],
                    lieIndex: 1,
                    explanation: "The lie is #2. Reformers wanted RAPID transformation to catch up with Europe, not gradual change.",
                    points: 60
                },
                {
                    statements: [
                        "The jizya tax on non-Muslims was replaced with a military exemption tax.",
                        "All subjects became equally eligible for military service in practice.",
                        "New land laws aimed to create clear property titles to increase tax revenue."
                    ],
                    lieIndex: 1,
                    explanation: "The lie is #2. While legally eligible, non-Muslim military service remained rare in practice.",
                    points: 65
                },
                {
                    statements: [
                        "The first Ottoman law school opened in 1859, teaching French legal codes.",
                        "Women gained equal inheritance rights under the new family laws.",
                        "Mixed commercial courts included European judges for cases involving foreigners."
                    ],
                    lieIndex: 1,
                    explanation: "The lie is #2. Women's rights saw little improvement; traditional Islamic inheritance laws largely continued.",
                    points: 70
                },
                {
                    statements: [
                        "Telegraph lines connected Istanbul to Baghdad by 1861.",
                        "Industrial factories produced most of the Empire's manufactured goods by 1880.",
                        "Railway construction relied heavily on European capital and engineers."
                    ],
                    lieIndex: 1,
                    explanation: "The lie is #2. Despite some factories, the Empire remained largely agricultural and imported manufactured goods.",
                    points: 75
                },
                {
                    statements: [
                        "The 1876 Constitution promised freedom of press and assembly.",
                        "All adult males gained voting rights regardless of property qualifications.",
                        "The constitution declared Islam as the state religion while guaranteeing religious freedom."
                    ],
                    lieIndex: 1,
                    explanation: "The lie is #2. Voting was limited to propertied males, excluding most of the population.",
                    points: 80
                }
            ]
        };

        // Game State
        const gameState = {
            players: [],
            currentPlayerIndex: 0,
            gameActive: false,
            currentCard: null,
            currentSpace: null,
            diceRolled: false,
            questionAnswered: false
        };

        // DOM Elements
        const playerSetup = document.getElementById('playerSetup');
        const gameContainer = document.getElementById('gameContainer');
        const playerCountSelect = document.getElementById('playerCount');
        const playerForms = document.getElementById('playerForms');
        const startGameBtn = document.getElementById('startGameBtn');
        const gameBoard = document.getElementById('gameBoard');
        const playersPanel = document.getElementById('playersPanel');
        const dice = document.getElementById('dice');
        const rollDiceBtn = document.getElementById('rollDiceBtn');
        const nextTurnBtn = document.getElementById('nextTurnBtn');
        const currentPlayerNameEl = document.getElementById('currentPlayerName');
        const currentCategoryEl = document.getElementById('currentCategory');
        const cardTextEl = document.getElementById('cardText');
        const answerOptionsEl = document.getElementById('answerOptions');
        const factResultEl = document.getElementById('factResult');
        const logEntriesEl = document.getElementById('logEntries');
        const diceResultEl = document.getElementById('diceResult');
        const winnerBanner = document.getElementById('winnerBanner');
        const winnerMessage = document.getElementById('winnerMessage');

        // Initialize player forms
        function initializePlayerForms() {
            const count = parseInt(playerCountSelect.value);
            playerForms.innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                playerForms.innerHTML += `
                    <div class="player-input-group">
                        <label>Reformer ${i + 1} Name</label>
                        <input type="text" id="playerName${i}" value="${PLAYER_NAMES[i] || `Reformer ${i + 1}`}">
                        <label>Choose Color</label>
                        <select id="playerColor${i}">
                            ${PLAYER_COLORS.map((color, idx) => 
                                `<option value="${color}" ${idx === i ? 'selected' : ''}>Color ${idx + 1}</option>`
                            ).join('')}
                        </select>
                        <div class="player-color-preview" id="colorPreview${i}" style="background: ${PLAYER_COLORS[i]}"></div>
                    </div>
                `;
                
                // Add event listener for color preview
                document.getElementById(`playerColor${i}`).addEventListener('change', (e) => {
                    document.getElementById(`colorPreview${i}`).style.background = e.target.value;
                });
            }
        }

        // Generate the board
        function generateBoard() {
            gameBoard.innerHTML = '';
            
            // Create 10x10 grid (snake pattern like Chutes and Ladders)
            for (let row = 9; row >= 0; row--) {
                const isReverseRow = row % 2 === 1; // Odd rows go right-to-left
                
                for (let col = 0; col < 10; col++) {
                    const cellIndex = isReverseRow ? row * 10 + (9 - col) : row * 10 + col;
                    const space = BOARD_SPACES[cellIndex];
                    
                    const cell = document.createElement('div');
                    cell.className = `board-cell`;
                    cell.dataset.index = cellIndex;
                    cell.id = `cell-${cellIndex}`;
                    
                    cell.innerHTML = `
                        <div class="cell-number">${space.number}</div>
                        <div class="cell-title">${space.title}</div>
                        ${space.description ? `<div class="cell-description">${space.description}</div>` : ''}
                    `;
                    
                    // Add visual indicators
                    if (space.type === 'ladder') {
                        cell.style.background = '#e8f5e9';
                        cell.style.borderColor = '#4caf50';
                    } else if (space.type === 'chute') {
                        cell.style.background = '#ffebee';
                        cell.style.borderColor = '#f44336';
                    } else if (space.type === 'question') {
                        cell.style.background = '#e3f2fd';
                        cell.style.borderColor = '#2196f3';
                    } else if (space.type === 'event') {
                        cell.style.background = '#fff3e0';
                        cell.style.borderColor = '#ff9800';
                    }
                    
                    gameBoard.appendChild(cell);
                }
            }
            
            // Draw ladders and chutes
            drawLaddersAndChutes();
            
            // Update player tokens
            updatePlayerTokens();
        }

        // Draw visual ladders and chutes
        function drawLaddersAndChutes() {
            // This is a simplified visual representation
            // In a full implementation, you'd draw SVG lines between cells
        }

        // Update player tokens on board
        function updatePlayerTokens() {
            // Clear existing tokens
            document.querySelectorAll('.player-token').forEach(token => token.remove());
            
            // Add tokens for each player
            gameState.players.forEach((player, playerIndex) => {
                const cell = document.getElementById(`cell-${player.position}`);
                if (cell) {
                    const token = document.createElement('div');
                    token.className = 'player-token';
                    token.style.background = player.color;
                    token.style.left = `${15 + playerIndex * 20}px`; // Stagger tokens
                    cell.appendChild(token);
                    
                    // Highlight current player's cell
                    if (playerIndex === gameState.currentPlayerIndex) {
                        cell.classList.add('active');
                    } else {
                        cell.classList.remove('active');
                    }
                }
            });
        }

        // Generate player cards
        function updatePlayerCards() {
            playersPanel.innerHTML = '';
            
            gameState.players.forEach((player, index) => {
                const isActive = index === gameState.currentPlayerIndex;
                const card = document.createElement('div');
                card.className = `player-card ${isActive ? 'active' : ''}`;
                card.innerHTML = `
                    <div class="player-header">
                        <div class="player-color-indicator" style="background: ${player.color}"></div>
                        <div class="player-name">${player.name}</div>
                        ${isActive ? 'üëë' : ''}
                    </div>
                    <div class="player-stats">
                        <div class="stat-item">
                            <span>Position:</span>
                            <span class="stat-value">${player.position + 1}</span>
                        </div>
                        <div class="stat-item">
                            <span>Knowledge:</span>
                            <span class="stat-value">${player.knowledgePoints}</span>
                        </div>
                        <div class="stat-item">
                            <span>Level:</span>
                            <span class="stat-value">${player.modernizationLevel}</span>
                        </div>
                        <div class="stat-item">
                            <span>Correct:</span>
                            <span class="stat-value">${player.correctAnswers || 0}</span>
                        </div>
                    </div>
                `;
                playersPanel.appendChild(card);
            });
        }

        // Start the game
        function startGame() {
            gameState.players = [];
            const playerCount = parseInt(playerCountSelect.value);
            
            for (let i = 0; i < playerCount; i++) {
                gameState.players.push({
                    name: document.getElementById(`playerName${i}`).value,
                    color: document.getElementById(`playerColor${i}`).value,
                    knowledgePoints: STARTING_KNOWLEDGE,
                    modernizationLevel: 1,
                    position: 0, // Start at position 0 (space 1)
                    turnCount: 0,
                    correctAnswers: 0
                });
            }
            
            gameState.currentPlayerIndex = 0;
            gameState.gameActive = true;
            gameState.diceRolled = false;
            gameState.questionAnswered = false;
            
            playerSetup.style.display = 'none';
            gameContainer.style.display = 'block';
            
            generateBoard();
            updatePlayerCards();
            updateCurrentPlayerDisplay();
            
            addLog(`Reform journey begins! ${playerCount} reformers competing to modernize the Empire.`);
            enableRollDice();
        }

        // Update current player display
        function updateCurrentPlayerDisplay() {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            currentPlayerNameEl.textContent = currentPlayer.name;
            currentPlayerNameEl.style.color = currentPlayer.color;
        }

        // Enable/disable dice roll
        function enableRollDice() {
            rollDiceBtn.disabled = false;
            nextTurnBtn.disabled = true;
            nextTurnBtn.style.display = 'none';
            rollDiceBtn.style.display = 'block';
            gameState.diceRolled = false;
            gameState.questionAnswered = false;
        }

        // Roll dice
        async function rollDice() {
            if (!gameState.gameActive || gameState.diceRolled) return;
            
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            
            // Disable roll button during animation
            rollDiceBtn.disabled = true;
            rollDiceBtn.textContent = 'Rolling...';
            
            // Add rolling animation
            dice.classList.add('rolling');
            
            // Roll animation for 1 second
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            // Generate dice value (1-6)
            const diceValue = Math.floor(Math.random() * 6) + 1;
            
            // Update dice display
            dice.textContent = getDiceFace(diceValue);
            diceResultEl.textContent = `${currentPlayer.name} rolled a ${diceValue}!`;
            
            // Remove rolling animation
            dice.classList.remove('rolling');
            
            gameState.diceRolled = true;
            
            // Move player
            moveCurrentPlayer(diceValue);
        }

        // Get dice face Unicode character
        function getDiceFace(value) {
            const faces = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];
            return faces[value - 1];
        }

        // Move current player
        function moveCurrentPlayer(spaces) {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const oldPosition = currentPlayer.position;
            
            // Calculate new position
            let newPosition = currentPlayer.position + spaces;
            
            // Check if reached or passed 100
            if (newPosition >= 99) {
                newPosition = 99; // Last space
                endGame(currentPlayer);
                return;
            }
            
            currentPlayer.position = newPosition;
            
            // Update display
            updatePlayerTokens();
            updatePlayerCards();
            
            addLog(`${currentPlayer.name} moves ${spaces} spaces to position ${newPosition + 1}`);
            
            // Check for ladder or chute
            const space = BOARD_SPACES[newPosition];
            if (space.type === 'ladder') {
                currentPlayer.position = space.ladderTo - 1; // Convert to 0-based index
                addLog(`ü™ú ${currentPlayer.name} climbs a reform ladder to position ${space.ladderTo}!`);
                updatePlayerTokens();
            } else if (space.type === 'chute') {
                currentPlayer.position = space.chuteTo - 1; // Convert to 0-based index
                addLog(`üõù ${currentPlayer.name} slides down a setback chute to position ${space.chuteTo}!`);
                updatePlayerTokens();
            }
            
            // Land on space
            setTimeout(() => landOnSpace(currentPlayer.position), 500);
        }

        // Land on a space
        function landOnSpace(spaceIndex) {
            const space = BOARD_SPACES[spaceIndex];
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            
            // Mark current space
            gameState.currentSpace = spaceIndex;
            
            // Handle different space types
            if (space.type === 'question' && !space.answered) {
                // Question space - only if not already answered
                gameState.currentCard = getRandomFact(space.category);
                displayCard(space.category, gameState.currentCard);
                nextTurnBtn.style.display = 'none';
                rollDiceBtn.style.display = 'none';
            } else if (space.type === 'event') {
                // Event space
                handleEventSpace(space);
            } else {
                // Normal space or already answered question
                cardTextEl.innerHTML = `
                    <h3>${space.title}</h3>
                    <p>${space.description || 'Continue your reform journey.'}</p>
                    ${space.answered ? '<p><em>(Question already answered)</em></p>' : ''}
                `;
                enableNextTurn();
            }
        }

        // Handle event space
        function handleEventSpace(space) {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const events = [
                { effect: 'gain', points: 30, message: 'Reform momentum builds!' },
                { effect: 'lose', points: 20, message: 'Conservative opposition slows progress' },
                { effect: 'gain', points: 50, message: 'Foreign investment aids development!' },
                { effect: 'lose', points: 30, message: 'Economic crisis hits' },
                { effect: 'gain', points: 40, message: 'Diplomatic success!' }
            ];
            
            const event = events[Math.floor(Math.random() * events.length)];
            
            if (event.effect === 'gain') {
                currentPlayer.knowledgePoints += event.points;
                showResult(true, `${event.message} +${event.points} Knowledge Points`);
            } else {
                currentPlayer.knowledgePoints = Math.max(0, currentPlayer.knowledgePoints - event.points);
                showResult(false, `${event.message} -${event.points} Knowledge Points`);
            }
            
            cardTextEl.innerHTML = `
                <h3>${space.title}</h3>
                <p>${space.description}</p>
                <p><strong>Event:</strong> ${event.message}</p>
            `;
            
            updatePlayerCards();
            enableNextTurn();
        }

        // Display card based on category
        function displayCard(category, card) {
            answerOptionsEl.style.display = 'none';
            factResultEl.style.display = 'none';
            answerOptionsEl.innerHTML = '';
            
            // Update category title
            const categoryNames = {
                'did-you-know': 'Did You Know?',
                'true-false': 'True or False?',
                'what-next': 'What Happened Next?',
                'two-truths': 'Two Truths & a Lie'
            };
            
            currentCategoryEl.textContent = categoryNames[category];
            
            // Display content based on category
            switch(category) {
                case 'did-you-know':
                    cardTextEl.textContent = card.text;
                    answerOptionsEl.innerHTML = `
                        <button class="answer-btn" onclick="answerQuestion(true)" id="answerBtn">Learn This (Earn ${card.points} points)</button>
                    `;
                    answerOptionsEl.style.display = 'block';
                    break;
                    
                case 'true-false':
                    cardTextEl.textContent = card.text;
                    answerOptionsEl.innerHTML = `
                        <button class="answer-btn" onclick="answerTrueFalse(true)">True</button>
                        <button class="answer-btn" onclick="answerTrueFalse(false)">False</button>
                    `;
                    answerOptionsEl.style.display = 'block';
                    break;
                    
                case 'what-next':
                    cardTextEl.textContent = card.setup;
                    answerOptionsEl.innerHTML = card.options.map((option, index) => `
                        <button class="answer-btn" onclick="answerWhatNext(${index})">${option}</button>
                    `).join('');
                    answerOptionsEl.style.display = 'block';
                    break;
                    
                case 'two-truths':
                    cardTextEl.innerHTML = `
                        <strong>Which statement is the LIE?</strong><br><br>
                        ${card.statements.map((stmt, idx) => 
                            `${idx + 1}. ${stmt}<br><br>`
                        ).join('')}
                    `;
                    answerOptionsEl.innerHTML = card.statements.map((stmt, index) => `
                        <button class="answer-btn" onclick="answerTwoTruths(${index})">Statement ${index + 1}</button>
                    `).join('');
                    answerOptionsEl.style.display = 'block';
                    break;
            }
            
            // Disable answer buttons after clicking
            setTimeout(() => {
                document.querySelectorAll('.answer-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.answer-btn').forEach(b => b.disabled = true);
                    });
                });
            }, 100);
        }

        // Get random fact from category
        function getRandomFact(category) {
            const categoryFacts = facts[category];
            return categoryFacts[Math.floor(Math.random() * categoryFacts.length)];
        }

        // Answer handlers
        function answerQuestion(isCorrect) {
            if (gameState.questionAnswered) return;
            
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const card = gameState.currentCard;
            
            currentPlayer.knowledgePoints += card.points;
            currentPlayer.correctAnswers = (currentPlayer.correctAnswers || 0) + 1;
            
            // Mark space as answered
            if (gameState.currentSpace !== null) {
                BOARD_SPACES[gameState.currentSpace].answered = true;
                document.getElementById(`cell-${gameState.currentSpace}`).classList.add('space-answered');
            }
            
            showResult(true, `Knowledge gained! +${card.points} Points`);
            addLog(`${currentPlayer.name} learned about ${BOARD_SPACES[gameState.currentSpace]?.title || 'reforms'}`);
            
            checkLevelUp(currentPlayer);
            updatePlayerCards();
            gameState.questionAnswered = true;
            
            setTimeout(enableNextTurn, 1500);
        }

        function answerTrueFalse(userAnswer) {
            if (gameState.questionAnswered) return;
            
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const card = gameState.currentCard;
            const isCorrect = userAnswer === card.answer;
            
            if (isCorrect) {
                currentPlayer.knowledgePoints += card.points;
                currentPlayer.correctAnswers = (currentPlayer.correctAnswers || 0) + 1;
                
                // Mark space as answered
                if (gameState.currentSpace !== null) {
                    BOARD_SPACES[gameState.currentSpace].answered = true;
                    document.getElementById(`cell-${gameState.currentSpace}`).classList.add('space-answered');
                }
                
                showResult(true, `Correct! ${card.explanation} +${card.points} Points`);
                addLog(`${currentPlayer.name} answered True/False correctly!`);
            } else {
                showResult(false, `Incorrect. ${card.explanation}`);
                addLog(`${currentPlayer.name} answered True/False incorrectly.`);
            }
            
            checkLevelUp(currentPlayer);
            updatePlayerCards();
            gameState.questionAnswered = true;
            
            setTimeout(enableNextTurn, 1500);
        }

        function answerWhatNext(selectedIndex) {
            if (gameState.questionAnswered) return;
            
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const card = gameState.currentCard;
            const isCorrect = selectedIndex === card.correct;
            
            if (isCorrect) {
                currentPlayer.knowledgePoints += card.points;
                currentPlayer.correctAnswers = (currentPlayer.correctAnswers || 0) + 1;
                
                // Mark space as answered
                if (gameState.currentSpace !== null) {
                    BOARD_SPACES[gameState.currentSpace].answered = true;
                    document.getElementById(`cell-${gameState.currentSpace}`).classList.add('space-answered');
                }
                
                showResult(true, `Correct! ${card.explanation} +${card.points} Points`);
                addLog(`${currentPlayer.name} predicted historical sequence correctly!`);
            } else {
                showResult(false, `Incorrect. ${card.explanation}`);
                addLog(`${currentPlayer.name} made wrong historical prediction.`);
            }
            
            checkLevelUp(currentPlayer);
            updatePlayerCards();
            gameState.questionAnswered = true;
            
            setTimeout(enableNextTurn, 1500);
        }

        function answerTwoTruths(selectedIndex) {
            if (gameState.questionAnswered) return;
            
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const card = gameState.currentCard;
            const isCorrect = selectedIndex === card.lieIndex;
            
            if (isCorrect) {
                currentPlayer.knowledgePoints += card.points;
                currentPlayer.correctAnswers = (currentPlayer.correctAnswers || 0) + 1;
                
                // Mark space as answered
                if (gameState.currentSpace !== null) {
                    BOARD_SPACES[gameState.currentSpace].answered = true;
                    document.getElementById(`cell-${gameState.currentSpace}`).classList.add('space-answered');
                }
                
                showResult(true, `Correct detective work! ${card.explanation} +${card.points} Points`);
                addLog(`${currentPlayer.name} found the lie successfully!`);
            } else {
                showResult(false, `Not quite. ${card.explanation}`);
                addLog(`${currentPlayer.name} chose wrong in Two Truths & a Lie`);
            }
            
            checkLevelUp(currentPlayer);
            updatePlayerCards();
            gameState.questionAnswered = true;
            
            setTimeout(enableNextTurn, 1500);
        }

        // Check for level up
        function checkLevelUp(player) {
            if (player.knowledgePoints >= 200 && player.modernizationLevel === 1) {
                player.modernizationLevel = 2;
                addLog(`üéâ ${player.name} reached Modernization Level 2!`);
            } else if (player.knowledgePoints >= 350 && player.modernizationLevel === 2) {
                player.modernizationLevel = 3;
                addLog(`üéâ ${player.name} reached Modernization Level 3 (Constitutional Era)!`);
            } else if (player.knowledgePoints >= 500 && player.modernizationLevel === 3) {
                player.modernizationLevel = 4;
                addLog(`üéâ ${player.name} reached Modernization Level 4 (Industrial Revolution)!`);
            }
        }

        // Show result
        function showResult(isCorrect, message) {
            factResultEl.textContent = message;
            factResultEl.className = 'fact-result ' + (isCorrect ? 'correct' : 'incorrect');
            factResultEl.style.display = 'block';
        }

        // Enable next turn button
        function enableNextTurn() {
            nextTurnBtn.disabled = false;
            nextTurnBtn.style.display = 'block';
            rollDiceBtn.style.display = 'none';
        }

        // Next turn
        function nextTurn() {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            currentPlayer.turnCount++;
            
            // Move to next player
            gameState.currentPlayerIndex = (gameState.currentPlayerIndex + 1) % gameState.players.length;
            
            // Reset for next turn
            nextTurnBtn.style.display = 'none';
            rollDiceBtn.style.display = 'block';
            currentCategoryEl.textContent = 'Ready for Next Turn';
            cardTextEl.textContent = `${gameState.players[gameState.currentPlayerIndex].name}'s turn. Click "Roll Dice" to continue the reform journey!`;
            answerOptionsEl.style.display = 'none';
            factResultEl.style.display = 'none';
            diceResultEl.textContent = '';
            
            // Update display
            updateCurrentPlayerDisplay();
            updatePlayerCards();
            enableRollDice();
            
            addLog(`${gameState.players[gameState.currentPlayerIndex].name}'s turn to roll!`);
        }

        // End game
        function endGame(winner) {
            gameState.gameActive = false;
            rollDiceBtn.disabled = true;
            nextTurnBtn.disabled = true;
            
            winnerMessage.textContent = `${winner.name} has successfully implemented the Tanzimat Reforms and reached modernization!`;
            winnerBanner.style.display = 'block';
            
            addLog(`üèÜ ${winner.name} wins the reform race with ${winner.knowledgePoints} knowledge points!`);
        }

        // Reset game
        function resetGame() {
            winnerBanner.style.display = 'none';
            playerSetup.style.display = 'flex';
            gameContainer.style.display = 'none';
            
            // Reset board spaces
            BOARD_SPACES.forEach(space => {
                space.answered = false;
            });
        }

        // Add log entry
        function addLog(message) {
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.textContent = message;
            logEntriesEl.prepend(logEntry);
            
            // Keep only last 8 entries
            const entries = logEntriesEl.querySelectorAll('.log-entry');
            if (entries.length > 8) {
                entries[entries.length - 1].remove();
            }
        }

        // Event Listeners
        playerCountSelect.addEventListener('change', initializePlayerForms);
        startGameBtn.addEventListener('click', startGame);
        rollDiceBtn.addEventListener('click', rollDice);
        nextTurnBtn.addEventListener('click', nextTurn);

        // Initialize
        initializePlayerForms();
    </script>
</body>
</html>
